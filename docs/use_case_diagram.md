# ユースケース図・記述

## 1. ユースケース図 (Mermaid)

```mermaid
usecaseDiagram
actor "ユーザー" as User
actor "Google Maps API" as GMaps
actor "Firebase Auth" as Firebase
actor "OpenWeatherMap API" as WeatherAPI

package "さんぽAI (HM Shop)" {
    usecase "ログイン/登録" as UC1
    usecase "ログアウト" as UC2
    usecase "ルート検索" as UC3
    usecase "地図・ルート表示" as UC4
    usecase "スポット検索・表示" as UC5
    usecase "歩数・距離確認" as UC6
    usecase "天気情報確認" as UC7
}

User --> UC1
User --> UC2
User --> UC3
User --> UC4
User --> UC6
User --> UC7

UC1 ..> Firebase : 認証
UC2 ..> Firebase : サインアウト
UC3 ..> GMaps : 経路計算 (Directions API)
UC4 ..> GMaps : 地図表示 (Maps SDK)
UC5 ..> GMaps : スポット検索 (Places API)
UC3 <.. UC5 : <<extend>> (ルート沿いの検索)
UC7 ..> WeatherAPI : 天気取得 (Inferred)
```

## 2. ユースケース記述

### UC1: ログイン/登録
*   **概要**: ユーザーがアプリを利用するためにアカウントを作成、または既存のアカウントでログインする。
*   **アクター**: ユーザー
*   **事前条件**: なし
*   **事後条件**: ユーザーが認証され、メイン画面に遷移する。
*   **主な流れ**:
    1.  ユーザーがメールアドレスとパスワードを入力する。
    2.  システムがFirebase Authに認証を要求する。
    3.  認証成功後、システムはメイン画面を表示する。

### UC3: ルート検索
*   **概要**: 出発地、目的地（および任意の経由地）を指定して、ウォーキングルートを検索する。
*   **アクター**: ユーザー
*   **事前条件**: ログイン済みであること。
*   **事後条件**: 地図上にルートが表示される。
*   **主な流れ**:
    1.  ユーザーが出発地、目的地を入力する（任意で経由地も入力）。
    2.  ユーザーが入力を確定する（フォーカスを外す等）。
    3.  システムがGoogle Maps Directions APIに経路情報をリクエストする。
    4.  システムが取得した経路を地図上に描画する。

### UC5: スポット検索・表示
*   **概要**: 設定されたフィルタ（コンビニ、カフェ等）に基づき、ルート周辺のスポットを検索・表示する。
*   **アクター**: ユーザー
*   **事前条件**: ルートが表示されていること。
*   **主な流れ**:
    1.  ユーザーが「コンビニさんぽ」や「買い物さんぽ」などのフィルタを選択する。
    2.  システムがルート周辺の施設をGoogle Places APIで検索する。
    3.  該当する施設が地図上にマーカーとして表示される。

### UC6: 歩数・距離確認
*   **概要**: 日々の歩数と移動距離（週間グラフ）を確認する。
*   **アクター**: ユーザー
*   **事前条件**: アプリがインストールされており、歩数が記録されていること。
*   **主な流れ**:
    1.  ユーザーがメイン画面を表示する。
    2.  システムがローカルストレージ（SharedPreferences）から歩数データを読み込む。
    3.  システムが当日の歩数と週間移動距離グラフを表示する。
